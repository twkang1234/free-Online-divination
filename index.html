<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>白星奇老師 - 奇門遁甲線上占卜服務</title>
    <meta name="description" content="免費線上奇門遁甲占卜工具，隨機選擇八神、星門、八門，提供天干地支組合解讀">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        function RandomNumberPicker() {
            const [topNumber, setTopNumber] = React.useState('?');
            const [topRightNumber, setTopRightNumber] = React.useState('?');
            const [middleNumber, setMiddleNumber] = React.useState('?');
            const [middleRightNumber, setMiddleRightNumber] = React.useState('?');
            const [bottomNumber, setBottomNumber] = React.useState('?');
            const [bottomRightNumber, setBottomRightNumber] = React.useState('?');
            const [isAnimating, setIsAnimating] = React.useState([false, false, false, false, false, false]);
            const [isCompleted, setIsCompleted] = React.useState([false, false, false, false, false, false]);
            const [hasStarted, setHasStarted] = React.useState(false);
            const [leftStarted, setLeftStarted] = React.useState(false);
            const [rightStarted, setRightStarted] = React.useState(false);
            const [circleControlUsed, setCircleControlUsed] = React.useState(false);
            const [isCopied, setIsCopied] = React.useState(false);
            const [leftCopied, setLeftCopied] = React.useState(false);
            const [rightCopied, setRightCopied] = React.useState(false);
            const [showTopCircle, setShowTopCircle] = React.useState(true);

            // 數字對應的中文字符
            const numberToText = {
                '1': '值符',
                '2': '螣蛇',
                '3': '太陰',
                '4': '六合',
                '5': '白虎',
                '6': '玄武',
                '7': '九地',
                '8': '九天'
            };

            // 中央數字對應的星門
            const numberToStar = {
                '1': '天蓬',
                '2': '天任',
                '3': '天沖',
                '4': '天輔',
                '5': '天禽',
                '6': '天英',
                '7': '天芮',
                '8': '天柱',
                '9': '天心'
            };

            // 下方數字對應的八門
            const numberToDoor = {
                '1': '休門',
                '2': '生門',
                '3': '傷門',
                '4': '杜門',
                '5': '景門',
                '6': '死門',
                '7': '驚門',
                '8': '開門'
            };

            // 中間右側數字對應的天干（1-7）
            const numberToTianGan = {
                '1': '乙',
                '2': '丙',
                '3': '丁',
                '4': '戊',
                '5': '己',
                '6': '庚',
                '7': '辛'
            };

            // 下方右側數字對應的地支（1-7）
            const numberToDiZhi = {
                '1': '乙',
                '2': '丙',
                '3': '丁',
                '4': '戊',
                '5': '己',
                '6': '庚',
                '7': '辛'
            };

            // 天干地支組合解釋
            const tianGanDiZhiExplanations = {
                '乙乙': '乙加乙 (日奇伏吟): 不宜求名求利，只宜安分守己。',
                '乙丙': '乙加丙 (奇儀順遂): 吉星遷官進職，凶星夫妻反目。',
                '乙丁': '乙加丁 (奇儀相佐): 利於文書、考試，有人相助。',
                '乙戊': '乙加戊 (利陰害陽): 門凶事必破敗，門吉尚可謀為。',
                '乙己': '乙加己 (日奇入墓): 被土暗昧，門凶事凶。',
                '乙庚': '乙加庚 (日奇被刑): 爭訟不得，夫妻離散。',
                '乙辛': '乙加辛 (龍逃走): 陰人見喜，男人見災，住處不佳，車輛紛失。',
                '丙乙': '丙加乙 (日月並行): 公謀私為皆吉。',
                '丙丙': '丙加丙 (月奇悖師): 文書訴訟，破耗遺失。',
                '丙丁': '丙加丁 (星奇朱雀): 貴人文書吉利，常人平穩。',
                '丙戊': '丙加戊 (飛鳥跌穴): 謀為皆順，可獲大利。',
                '丙己': '丙加己 (火悖入刑): 囚人刑杖，文書不行。',
                '丙庚': '丙加庚 (熒入太白): 门户破败，盜賊耗失。',
                '丙辛': '丙加辛 (日月相會): 謀事成就，病人不凶。',
                '丁乙': '丁加乙 (玉女奇生): 人遁格，利於婚姻、文書、私事。',
                '丁丙': '丁加丙 (星隨月轉): 貴人升高，常人有喜。',
                '丁丁': '丁加丁 (奇入太陰): 文書即至，喜事遂心。',
                '丁戊': '丁加戊 (青龍轉光): 官人陞遷，常人威昌。',
                '丁己': '丁加己 (火入勾陳): 奸私仇冤，事體不明。',
                '丁庚': '丁加庚 (文書阻隔): 文書阻隔，行人必歸。',
                '丁辛': '丁加辛 (朱雀入獄): 罪人釋囚，官人失位。',
                '戊乙': '戊加乙 (青龍合靈): 門吉事吉，門凶事凶。',
                '戊丙': '戊加丙 (青龍返首): 動作大吉，若遇迫墓則凶。',
                '戊丁': '戊加丁 (青龍耀明): 官人陞遷，常人吉慶。',
                '戊戊': '戊加戊 (伏吟): 凡事閉塞，靜守為吉。',
                '戊己': '戊加己 (貴人入獄): 公私皆不利。',
                '戊庚': '戊加庚 (值符飛宮): 吉事不吉，凶事更凶。',
                '戊辛': '戊加辛 (青龍折足): 吉門生助尚可謀，逢凶門則招災失財。',
                '己乙': '己加乙 (墓神不明): 地戶逢星，宜遁跡隱形。',
                '己丙': '己加丙 (火悖地戶): 男人冤冤相害，女人必致淫污。',
                '己丁': '己加丁 (朱雀入墓): 文書詞訟，先曲後直。',
                '己戊': '己加戊 (犬遇青龍): 門吉謀望遂意，門凶枉勞心機。',
                '己己': '己加己 (地戶伏陰): 病人必死，百事不遂。',
                '己庚': '己加庚 (刑格): 利名不利，詞訟先動者不利。',
                '己辛': '己加辛 (遊魂入墓): 陰人鬼祟，小人作亂。',
                '庚乙': '庚加乙 (太白逢星): 退吉進凶，謀為不遂。',
                '庚丙': '庚加丙 (太白入熒): 占賊必來，為客進利，為主破財。',
                '庚丁': '庚加丁 (亭亭之格): 因私匿或男女關係起官司。',
                '庚戊': '庚加戊 (天乙伏宮): 百事不可謀，凶。',
                '庚己': '庚加己 (官符刑格): 文書官司，觸犯刑法。',
                '庚庚': '庚加庚 (太白同宮): 官災橫禍，兄弟不和。',
                '庚辛': '庚加辛 (白虎干格): 遠行車折馬死，求財更凶。',
                '辛乙': '辛加乙 (白虎猖狂): 人亡家敗，遠行多殃，尊長不喜。',
                '辛丙': '辛加丙 (干合悖師): 熒惑出現，占雨無，占晴旱。',
                '辛丁': '辛加丁 (獄神得奇): 經商獲倍利，罪人逢赦宥。',
                '辛戊': '辛加戊 (困龍被傷): 官司破敗，屈抑守分尚可。',
                '辛己': '辛加己 (入獄自刑): 奴僕背主，有理難伸。',
                '辛庚': '辛加庚 (白虎出力): 刀刃相接，主客相殘。',
                '辛辛': '辛加辛 (伏吟): 錯誤、後悔、兇。'
            };

            // 獲取天干地支組合解釋
            const getTianGanDiZhiExplanation = (tianGan, diZhi) => {
                if (tianGan === '?' || diZhi === '?') return '';
                const key = tianGan + diZhi;
                return tianGanDiZhiExplanations[key] || '';
            };

            // 安全的顯示函數
            const getDisplayText = (value, mapping) => {
                if (value === '?') return '?';
                return mapping[value] || '?';
            };

            // 複製左側結果到剪貼簿
            const copyLeftResult = async () => {
                if (isCompleted[0] && isCompleted[1] && isCompleted[3]) {
                    const resultText = `問測[工作] [${getDisplayText(topNumber, numberToText)} + ${getDisplayText(middleNumber, numberToStar)} + ${getDisplayText(bottomNumber, numberToDoor)}] 未來趨勢如何?`;
                    
                    try {
                        await navigator.clipboard.writeText(resultText);
                        setLeftCopied(true);
                        setTimeout(() => setLeftCopied(false), 2000);
                    } catch (err) {
                        const textArea = document.createElement('textarea');
                        textArea.value = resultText;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        setLeftCopied(true);
                        setTimeout(() => setLeftCopied(false), 2000);
                    }
                }
            };

            // 複製右側結果到剪貼簿
            const copyRightResult = async () => {
                if (isCompleted[2] && isCompleted[4]) {
                    const tianGan = getDisplayText(middleRightNumber, numberToTianGan);
                    const diZhi = getDisplayText(bottomRightNumber, numberToDiZhi);
                    const explanation = getTianGanDiZhiExplanation(tianGan, diZhi);
                    const resultText = explanation || `天干+地支組合 [${tianGan} + ${diZhi}]`;
                    
                    try {
                        await navigator.clipboard.writeText(resultText);
                        setRightCopied(true);
                        setTimeout(() => setRightCopied(false), 2000);
                    } catch (err) {
                        const textArea = document.createElement('textarea');
                        textArea.value = resultText;
                        document.body.appendChild(textArea);
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        setRightCopied(true);
                        setTimeout(() => setRightCopied(false), 2000);
                    }
                }
            };

            const generateRandomNumber = (index) => {
                if (isAnimating[index] || isCompleted[index]) return;
                
                // 設置動畫狀態
                setIsAnimating(prev => {
                    const newAnimating = [...prev];
                    newAnimating[index] = true;
                    return newAnimating;
                });
                
                // 動畫效果：持續4秒的隨機變化
                const animationInterval = setInterval(() => {
                    let randomNum;
                    if (index === 1) {
                        // 中央組使用 1-9
                        randomNum = Math.floor(Math.random() * 9) + 1;
                    } else if (index === 2) {
                        // 中間右側天干使用 1-7
                        randomNum = Math.floor(Math.random() * 7) + 1;
                    } else if (index === 4) {
                        // 下方右側地支使用 1-7
                        randomNum = Math.floor(Math.random() * 7) + 1;
                    } else {
                        // 其他組使用 1-8
                        randomNum = Math.floor(Math.random() * 8) + 1;
                    }
                    
                    if (index === 0) setTopNumber(randomNum.toString());
                    else if (index === 1) setMiddleNumber(randomNum.toString());
                    else if (index === 2) setMiddleRightNumber(randomNum.toString());
                    else if (index === 3) setBottomNumber(randomNum.toString());
                    else setBottomRightNumber(randomNum.toString());
                }, 100); // 每100毫秒變化一次
                
                // 4秒後停止動畫並設置最終結果
                setTimeout(() => {
                    clearInterval(animationInterval);
                    
                    // 最終結果
                    let finalNumber;
                    if (index === 1) {
                        // 中央組使用 1-9
                        finalNumber = Math.floor(Math.random() * 9) + 1;
                    } else if (index === 2) {
                        // 中間右側天干使用 1-7
                        finalNumber = Math.floor(Math.random() * 7) + 1;
                    } else if (index === 4) {
                        // 下方右側地支使用 1-7
                        finalNumber = Math.floor(Math.random() * 7) + 1;
                    } else {
                        // 其他組使用 1-8
                        finalNumber = Math.floor(Math.random() * 8) + 1;
                    }
                    
                    if (index === 0) setTopNumber(finalNumber.toString());
                    else if (index === 1) setMiddleNumber(finalNumber.toString());
                    else if (index === 2) setMiddleRightNumber(finalNumber.toString());
                    else if (index === 3) setBottomNumber(finalNumber.toString());
                    else setBottomRightNumber(finalNumber.toString());
                    
                    // 停止動畫
                    setIsAnimating(prev => {
                        const newAnimating = [...prev];
                        newAnimating[index] = false;
                        return newAnimating;
                    });
                    
                    // 標記為已完成
                    setIsCompleted(prev => {
                        const newCompleted = [...prev];
                        newCompleted[index] = true;
                        return newCompleted;
                    });
                }, 4000); // 4秒後停止
            };

            const startLeftProcess = () => {
                if (leftStarted) return;
                setLeftStarted(true);
                
                // 依序執行八神、星門、八門（索引 0, 1, 3）
                generateRandomNumber(0); // 八神
                setTimeout(() => generateRandomNumber(1), 4500);  // 星門
                setTimeout(() => generateRandomNumber(3), 9000);  // 八門
            };

            const startRightProcess = () => {
                if (rightStarted) return;
                setRightStarted(true);
                
                // 依序執行右側兩個變數（索引 2, 4）
                generateRandomNumber(2); // 天干
                setTimeout(() => generateRandomNumber(4), 4500);  // 地支
            };

            return React.createElement('div', {
                className: "flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8"
            }, [
                React.createElement('div', {
                    key: 'header',
                    className: "text-center mb-8 w-full flex flex-col items-center"
                }, [
                    React.createElement('h1', {
                        key: 'title',
                        className: "text-3xl font-bold text-gray-800 mb-2 text-center"
                    }, '免費線上占卜'),
                    React.createElement('p', {
                        key: 'subtitle',
                        className: "text-gray-600 text-center"
                    }, '點擊按鈕隨機選擇八神、星門、八門'),
                    React.createElement('p', {
                        key: 'instruction',
                        className: "text-gray-500 text-sm text-center mt-1"
                    }, '得到最後結果　複製提示詞　到自己喜好的ＡＩ去幫助你解盤')
                ]),

                // 方框顯示區域
                React.createElement('div', {
                    key: 'main-area',
                    className: "flex flex-col items-center space-y-6 mb-8"
                }, [
                    React.createElement('div', {
                        key: 'display-box',
                        className: "w-64 h-64 bg-white border-4 border-gray-300 rounded-lg shadow-lg flex flex-col items-center justify-center space-y-6"
                    }, [
                        // 上方區域：八神
                        React.createElement('div', {
                            key: 'top-area',
                            className: "flex items-center justify-center"
                        }, 
                            React.createElement('span', {
                                className: `text-3xl font-bold text-indigo-600 transition-all duration-200 ${isAnimating[0] ? 'scale-110 text-orange-500' : 'scale-100'}`
                            }, getDisplayText(topNumber, numberToText))
                        ),
                        
                        // 中間區域：星門和天干
                        React.createElement('div', {
                            key: 'middle-area',
                            className: "flex items-center space-x-4"
                        }, [
                            React.createElement('span', {
                                key: 'star',
                                className: `text-3xl font-bold text-indigo-600 transition-all duration-200 ${isAnimating[1] ? 'scale-110 text-orange-500' : 'scale-100'}`
                            }, getDisplayText(middleNumber, numberToStar)),
                            
                            React.createElement('span', {
                                key: 'tiangan',
                                className: `text-2xl font-bold text-red-600 border-2 border-red-400 px-2 py-1 rounded transition-all duration-200 ${isAnimating[2] ? 'scale-110 text-orange-500 border-orange-400' : 'scale-100'}`
                            }, getDisplayText(middleRightNumber, numberToTianGan))
                        ]),
                        
                        // 下方區域：八門和地支
                        React.createElement('div', {
                            key: 'bottom-area',
                            className: "flex items-center space-x-4"
                        }, [
                            React.createElement('span', {
                                key: 'door',
                                className: `text-3xl font-bold text-indigo-600 transition-all duration-200 ${isAnimating[3] ? 'scale-110 text-orange-500' : 'scale-100'}`
                            }, getDisplayText(bottomNumber, numberToDoor)),
                            
                            React.createElement('span', {
                                key: 'dizhi',
                                className: `text-2xl font-bold text-red-600 border-2 border-red-400 px-2 py-1 rounded transition-all duration-200 ${isAnimating[4] ? 'scale-110 text-orange-500 border-orange-400' : 'scale-100'}`
                            }, getDisplayText(bottomRightNumber, numberToDiZhi))
                        ])
                    ]),

                    // 兩個按鈕
                    React.createElement('div', {
                        key: 'buttons',
                        className: "flex space-x-4"
                    }, [
                        React.createElement('button', {
                            key: 'left-button',
                            onClick: startLeftProcess,
                            disabled: leftStarted,
                            className: `w-20 h-20 rounded-full shadow-lg text-white font-bold text-sm transition-all duration-200 ${leftStarted ? 'bg-gray-400 cursor-not-allowed opacity-50' : 'bg-indigo-500 hover:bg-indigo-600 hover:scale-105 active:scale-95'}`
                        }, (isCompleted[0] && isCompleted[1] && isCompleted[3]) ? '已完成' : (isAnimating[0] || isAnimating[1] || isAnimating[3]) ? '進行中...' : leftStarted ? '處理中' : '八神星門'),

                        React.createElement('button', {
                            key: 'right-button',
                            onClick: startRightProcess,
                            disabled: rightStarted,
                            className: `w-20 h-20 rounded-full shadow-lg text-white font-bold text-sm transition-all duration-200 ${rightStarted ? 'bg-gray-400 cursor-not-allowed opacity-50' : 'bg-red-500 hover:bg-red-600 hover:scale-105 active:scale-95'}`
                        }, (isCompleted[2] && isCompleted[4]) ? '已完成' : (isAnimating[2] || isAnimating[4]) ? '進行中...' : rightStarted ? '處理中' : '天干地支')
                    ])
                ]),

                // 兩個最終結果顯示
                React.createElement('div', {
                    key: 'results',
                    className: "flex flex-col lg:flex-row justify-center items-center gap-6 mb-8 w-full max-w-4xl mx-auto px-4"
                }, [
                    // 左側結果 - 八神星門八門
                    React.createElement('div', {
                        key: 'left-result',
                        onClick: copyLeftResult,
                        className: `flex-1 max-w-md p-6 bg-white border-2 border-indigo-200 rounded-lg shadow-lg transition-all duration-1000 ${(isCompleted[0] && isCompleted[1] && isCompleted[3]) ? 'transform scale-105 bg-gradient-to-r from-blue-100 to-indigo-100 border-indigo-400 shadow-2xl cursor-pointer hover:shadow-3xl hover:scale-110' : 'transform scale-100'} ${leftCopied ? 'bg-green-100 border-green-400' : ''}`,
                        title: (isCompleted[0] && isCompleted[1] && isCompleted[3]) ? "點擊複製結果" : ""
                    }, [
                        React.createElement('h2', {
                            key: 'left-title',
                            className: "text-lg font-bold text-gray-800 mb-4 text-center"
                        }, leftCopied ? '已複製！' : '八神星門八門結果'),
                        React.createElement('div', {
                            key: 'left-content',
                            className: `text-base font-bold text-center break-words transition-all duration-1000 ${(isCompleted[0] && isCompleted[1] && isCompleted[3]) ? 'text-indigo-600 text-lg' : 'text-gray-600'} ${leftCopied ? 'text-green-600' : ''}`
                        }, (isCompleted[0] && isCompleted[1] && isCompleted[3]) ? `問測[工作] [${getDisplayText(topNumber, numberToText)} + ${getDisplayText(middleNumber, numberToStar)} + ${getDisplayText(bottomNumber, numberToDoor)}] 未來趨勢如何?` : '問測[某事] [　　　　] 未來趨勢如何?'),
                        (isCompleted[0] && isCompleted[1] && isCompleted[3] && !leftCopied) ? React.createElement('div', {
                            key: 'left-hint',
                            className: "text-xs text-gray-500 text-center mt-2"
                        }, '點擊複製結果') : null
                    ]),

                    // 右側結果 - 數字變數
                    React.createElement('div', {
                        key: 'right-result',
                        onClick: copyRightResult,
                        className: `flex-1 max-w-md p-6 bg-white border-2 border-red-200 rounded-lg shadow-lg transition-all duration-1000 ${(isCompleted[2] && isCompleted[4]) ? 'transform scale-105 bg-gradient-to-r from-red-100 to-pink-100 border-red-400 shadow-2xl cursor-pointer hover:shadow-3xl hover:scale-110' : 'transform scale-100'} ${rightCopied ? 'bg-green-100 border-green-400' : ''}`,
                        title: (isCompleted[2] && isCompleted[4]) ? "點擊複製結果" : ""
                    }, [
                        React.createElement('h2', {
                            key: 'right-title',
                            className: "text-lg font-bold text-gray-800 mb-4 text-center"
                        }, rightCopied ? '已複製！' : '天干+地支 形成斷語'),
                        React.createElement('div', {
                            key: 'right-content',
                            className: `text-base font-bold text-center break-words transition-all duration-1000 ${(isCompleted[2] && isCompleted[4]) ? 'text-red-600 text-lg' : 'text-gray-600'} ${rightCopied ? 'text-green-600' : ''}`
                        }, (isCompleted[2] && isCompleted[4]) ? (() => {
                            const tianGan = getDisplayText(middleRightNumber, numberToTianGan);
                            const diZhi = getDisplayText(bottomRightNumber, numberToDiZhi);
                            const explanation = getTianGanDiZhiExplanation(tianGan, diZhi);
                            return explanation || `天干+地支組合 [${tianGan} + ${diZhi}]`;
                        })() : '天干+地支組合 [　　　　]'),
                        (isCompleted[2] && isCompleted[4] && !rightCopied) ? React.createElement('div', {
                            key: 'right-hint',
                            className: "text-xs text-gray-500 text-center mt-2"
                        }, '點擊複製結果') : null
                    ])
                ]),

                // 付費占卜按鈕
                React.createElement('div', {
                    key: 'paid-service',
                    className: "mt-8 text-center"
                }, [
                    React.createElement('a', {
                        key: 'paid-link',
                        href: "https://soul-treasure.net/",
                        target: "_blank",
                        rel: "noopener noreferrer",
                        className: "inline-block px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold text-lg rounded-full shadow-lg hover:from-purple-600 hover:to-pink-600 hover:scale-105 transform transition-all duration-300 hover:shadow-2xl"
                    }, '申請付費線上占卜'),
                    React.createElement('p', {
                        key: 'paid-description',
                        className: "text-sm text-gray-500 mt-2"
                    }, '專業占卜師為您提供更詳細的解讀')
                ])
            ]);
        }

        // 渲染到頁面
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(RandomNumberPicker));
    </script>
</body>
</html>
